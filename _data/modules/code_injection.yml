title: CWE-94 Improper Control of Generation of Code 'Code Injection' (grav)
status: released
location: /modules/code_injection_cve_2023_34448/
desc: >-
    Code injection attacks can lead to unauthorized command execution, or the Improper Control of Generation of Code. This vulnerability arises when a system inadequately manages the code it dynamically generates and executes, thereby allowing attackers to inject malicious code. Specifically, when a product does not adequately validate or sanitize user input that contains code syntax, attackers can craft input to alter the product's intended control flow, leading to arbitrary code execution. The impact of such vulnerabilities can be profound, potentially allowing attackers to gain control over affected systems or access sensitive data. 
software:
  - title: grav
    desc: A Content Management System (CMS) is a software tool that allows you to create, edit, and manage digital content on websites without needing specialized technical knowledge. Grav is an example of such a tool, characterized by its speed, simplicity, and flexibility. It operates on a file-based system, meaning there's no complex installation process; users can get started by simply unzipping an archive. 
    url: https://github.com/getgrav/grav
cwes:
 - cweid: CWE-94
   title: Improper Control of Generation of Code - 'Code Injection'
   url: https://cwe.mitre.org/data/definitions/94.html
cves:
 - cveid: CVE-2023-34448
   url: https://nvd.nist.gov/vuln/detail/CVE-2023-34448
   desc: Grav, a CMS based on a flat-file architecture, encountered a security flaw described by CVE-2022-2073 before the release of version 1.7.42. This vulnerability, a server-side template injection issue, stemmed from the improper restriction of the default `filter()` function in Grav. It failed to limit access to other internal functions provided by Twig's Core Extension, which could be exploited to execute arbitrary, unsafe functions remotely. 
   references:
    - title: GitHub Advisory Database Explaination
      url: https://github.com/advisories/GHSA-whr7-m3f8-mpm8

